<!DOCTYPE html>
<html lang="en-us">

  {% include head.html %}

  <body class="notes-page">

    <header class="site-header">
      <div class="header-container">
        <a href="{{ site.baseurl }}/" class="site-title">{{ site.author.name }}</a>
        <nav class="site-nav">
          <a class="nav-link{% if page.title == 'Articles' or page.collection == 'articles' %} active{% endif %}" href="{{ '/articles/' | absolute_url }}">Articles</a>
          <a class="nav-link{% if page.title == 'Notes' or page.collection == 'notes' %} active{% endif %}" href="{{ '/notes/' | absolute_url }}">Notes</a>
          <a class="nav-link{% if page.title == 'Photography' or page.collection == 'photography' %} active{% endif %}" href="{{ '/photography/' | absolute_url }}">Photography</a>
          <a class="nav-link{% if page.title == 'About' %} active{% endif %}" href="{{ '/about/' | absolute_url }}">About</a>
        </nav>
      </div>
    </header>

    <div class="notes-layout">
      <aside class="notes-sidebar">
        <nav class="notes-nav">
          {% assign folders = "" | split: "" %}
          {% assign root_notes = "" | split: "" %}

          {% for note in site.notes %}
            {% assign path_parts = note.path | split: '/' %}
            {% if path_parts.size > 2 %}
              {% assign folder_name = path_parts[1] %}
              {% unless folders contains folder_name %}
                {% assign folders = folders | push: folder_name %}
              {% endunless %}
            {% else %}
              {% assign root_notes = root_notes | push: note %}
            {% endif %}
          {% endfor %}

          {% assign sorted_root = root_notes | sort: "title" %}
          {% for note in sorted_root %}
            <a class="notes-nav-item{% if page.url == note.url %} active{% endif %}" href="{{ site.baseurl }}{{ note.url }}">
              {{ note.title }}
            </a>
          {% endfor %}

          {% assign sorted_folders = folders | sort %}
          {% for folder in sorted_folders %}
            <span class="notes-folder">{{ folder | replace: "_", " " | capitalize }}</span>
            {% assign folder_notes = site.notes | where_exp: "note", "note.path contains folder" | sort: "title" %}
            {% for note in folder_notes %}
              {% assign note_parts = note.path | split: '/' %}
              {% if note_parts[1] == folder %}
                <a class="notes-nav-item notes-nav-child{% if page.url == note.url %} active{% endif %}" href="{{ site.baseurl }}{{ note.url }}">
                  {{ note.title }}
                </a>
              {% endif %}
            {% endfor %}
          {% endfor %}
        </nav>
      </aside>

      <main class="notes-content">
        <article class="note">
          <h1 class="page-title">{{ page.title }}</h1>
          {% if page.date and page.collection == 'notes' %}
          <span class="note-date">{{ page.date | date: "%b %d, %Y" }}</span>
          {% endif %}
          <div class="note-body">
            {{ content }}
          </div>
        </article>
      </main>
    </div>

  </body>
</html>
