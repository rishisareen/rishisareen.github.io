<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recipe Manager</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }

        .header h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .main-content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }

        .nav-tabs {
            display: flex;
            background: #f8f9fa;
            border-radius: 15px;
            padding: 5px;
            margin-bottom: 30px;
            gap: 5px;
        }

        .nav-tab {
            flex: 1;
            background: transparent;
            border: none;
            padding: 15px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            color: #666;
        }

        .nav-tab.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .nav-tab:hover:not(.active) {
            background: #e9ecef;
            transform: translateY(-1px);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .search-bar {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid #e9ecef;
            border-radius: 15px;
            font-size: 1rem;
            margin-bottom: 25px;
            transition: all 0.3s ease;
        }

        .search-bar:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #444;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        .form-group textarea {
            min-height: 150px;
            resize: vertical;
            font-family: 'Courier New', monospace;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #6c757d;
            margin-left: 10px;
        }

        .btn-secondary:hover {
            box-shadow: 0 10px 25px rgba(108, 117, 125, 0.4);
        }

        .recipe-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 25px;
            margin-top: 25px;
        }

        .recipe-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .recipe-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
            border-color: #667eea;
        }

        .recipe-title {
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 10px;
            color: #333;
        }

        .recipe-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            font-size: 0.9rem;
            color: #666;
        }

        .rating {
            display: flex;
            gap: 2px;
        }

        .star {
            color: #ffc107;
            font-size: 1.2rem;
        }

        .star.empty {
            color: #e9ecef;
        }

        .recipe-preview {
            color: #666;
            line-height: 1.5;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            backdrop-filter: blur(5px);
            z-index: 1000;
            overflow-y: auto;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 800px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }

        .modal-close {
            position: absolute;
            top: 20px;
            right: 25px;
            background: #f8f9fa;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 1.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            background: #e9ecef;
            transform: rotate(90deg);
        }

        .recipe-content {
            white-space: pre-wrap;
            font-family: 'Courier New', monospace;
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 4px solid #667eea;
        }

        .history-section {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #e9ecef;
        }

        .history-entry {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            border-left: 4px solid #28a745;
        }

        .history-date {
            font-weight: 600;
            color: #495057;
            margin-bottom: 5px;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #666;
        }

        .empty-state h3 {
            font-size: 1.5rem;
            margin-bottom: 10px;
        }

        .google-drive-note {
            background: #e3f2fd;
            border: 1px solid #2196f3;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 25px;
            font-size: 0.9rem;
            color: #1565c0;
        }

        .sort-controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            align-items: center;
        }

        .sort-controls select {
            padding: 8px 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            .header h1 {
                font-size: 2rem;
            }

            .nav-tabs {
                flex-direction: column;
            }

            .recipe-grid {
                grid-template-columns: 1fr;
            }

            .modal-content {
                padding: 25px;
                margin: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üç≥ Recipe Manager</h1>
            <p>Your personal recipe collection with Google Drive sync</p>
        </div>

        <div class="main-content">
            <div class="nav-tabs">
                <button class="nav-tab active" onclick="switchTab('recipes')">My Recipes</button>
                <button class="nav-tab" onclick="switchTab('add')">Add Recipe</button>
            </div>

            <!-- Recipes Tab -->
            <div id="recipes-tab" class="tab-content active">
                <div class="google-drive-note">
                    üìÅ Recipes are automatically saved to your Google Drive folder for backup and sync
                </div>

                <input type="text" class="search-bar" id="searchInput" placeholder="üîç Search recipes by title, ingredients, or notes...">

                <div class="sort-controls">
                    <label>Sort by:</label>
                    <select id="sortSelect">
                        <option value="date-desc">Newest First</option>
                        <option value="date-asc">Oldest First</option>
                        <option value="title-asc">Title A-Z</option>
                        <option value="title-desc">Title Z-A</option>
                        <option value="rating-desc">Highest Rated</option>
                        <option value="rating-asc">Lowest Rated</option>
                    </select>
                </div>

                <div id="recipesContainer" class="recipe-grid">
                    <div class="empty-state">
                        <h3>No recipes yet!</h3>
                        <p>Start by adding your first recipe using the "Add Recipe" tab.</p>
                    </div>
                </div>
            </div>

            <!-- Add Recipe Tab -->
            <div id="add-tab" class="tab-content">
                <form id="recipeForm">
                    <div class="form-group">
                        <label for="recipeTitle">Recipe Title</label>
                        <input type="text" id="recipeTitle" required placeholder="e.g., Grandma's Chocolate Chip Cookies">
                    </div>

                    <div class="form-group">
                        <label for="recipeRating">Rating (1-5 stars)</label>
                        <select id="recipeRating" required>
                            <option value="">Select rating...</option>
                            <option value="1">‚≠ê (1 star)</option>
                            <option value="2">‚≠ê‚≠ê (2 stars)</option>
                            <option value="3">‚≠ê‚≠ê‚≠ê (3 stars)</option>
                            <option value="4">‚≠ê‚≠ê‚≠ê‚≠ê (4 stars)</option>
                            <option value="5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (5 stars)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="recipeContent">Recipe (Markdown Format)</label>
                        <textarea id="recipeContent" required placeholder="## Ingredients
- 2 cups flour
- 1 cup sugar
- 1/2 cup butter

## Instructions
1. Preheat oven to 350¬∞F
2. Mix dry ingredients...

## Notes
- Best served warm
- Can be frozen for up to 3 months"></textarea>
                    </div>

                    <div class="form-group">
                        <label for="recipeHistory">Cooking History & Notes</label>
                        <textarea id="recipeHistory" placeholder="## Cooking History

### 2025-01-15
Made this for dinner party. Everyone loved it! Next time use less salt.

### 2024-12-20
First attempt. Turned out great but took longer than expected.

## Future Notes
- Try adding herbs next time
- Double the recipe for larger groups"></textarea>
                    </div>

                    <button type="submit" class="btn">Save Recipe</button>
                    <button type="button" class="btn btn-secondary" onclick="clearForm()">Clear Form</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Recipe View Modal -->
    <div id="recipeModal" class="modal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal()">&times;</button>
            <div id="modalContent"></div>
        </div>
    </div>

    <script>
        // Recipe storage
        let recipes = JSON.parse(localStorage.getItem('recipes') || '[]');
        
        // Google Drive configuration
        const GOOGLE_DRIVE_FOLDER_ID = '13OG2UXKUHQco5OrytKhO02A_D5HAh9_B';
        const GOOGLE_DRIVE_FOLDER_URL = 'https://drive.google.com/drive/folders/13OG2UXKUHQco5OrytKhO02A_D5HAh9_B?usp=sharing';

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            displayRecipes();
            setupEventListeners();
        });

        function setupEventListeners() {
            // Search functionality
            document.getElementById('searchInput').addEventListener('input', function() {
                displayRecipes(this.value);
            });

            // Sort functionality
            document.getElementById('sortSelect').addEventListener('change', function() {
                displayRecipes(document.getElementById('searchInput').value);
            });

            // Form submission
            document.getElementById('recipeForm').addEventListener('submit', function(e) {
                e.preventDefault();
                saveRecipe();
            });
        }

        function switchTab(tabName) {
            // Update nav tabs
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');

            // Update tab content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(tabName + '-tab').classList.add('active');
        }

        function saveRecipe() {
            const title = document.getElementById('recipeTitle').value;
            const rating = parseInt(document.getElementById('recipeRating').value);
            const content = document.getElementById('recipeContent').value;
            const history = document.getElementById('recipeHistory').value;

            const recipe = {
                id: Date.now(),
                title: title,
                rating: rating,
                content: content,
                history: history,
                dateCreated: new Date().toISOString(),
                dateModified: new Date().toISOString()
            };

            recipes.push(recipe);
            localStorage.setItem('recipes', JSON.stringify(recipes));

            // Generate markdown file content
            const markdownContent = generateMarkdownFile(recipe);
            
            // Create and download the markdown file
            downloadMarkdownFile(recipe.title, markdownContent);

            // Show success message and reset form
            alert('Recipe saved successfully! The markdown file has been downloaded. Please upload it to your Google Drive folder.');
            clearForm();
            switchTab('recipes');
            displayRecipes();
        }

        function generateMarkdownFile(recipe) {
            const date = new Date(recipe.dateCreated).toLocaleDateString();
            return `# ${recipe.title}

**Created:** ${date}  
**Rating:** ${'‚≠ê'.repeat(recipe.rating)}

---

${recipe.content}

---

## Cooking History & Notes

${recipe.history || 'No history yet.'}

---

*Recipe ID: ${recipe.id}*
*Last Modified: ${new Date(recipe.dateModified).toLocaleString()}*
`;
        }

        function downloadMarkdownFile(title, content) {
            const blob = new Blob([content], { type: 'text/markdown' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${title.replace(/[^a-z0-9]/gi, '_').toLowerCase()}.md`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function displayRecipes(searchTerm = '') {
            const container = document.getElementById('recipesContainer');
            let filteredRecipes = recipes;

            // Filter by search term
            if (searchTerm) {
                filteredRecipes = recipes.filter(recipe => 
                    recipe.title.toLowerCase().includes(searchTerm.toLowerCase()) ||
                    recipe.content.toLowerCase().includes(searchTerm.toLowerCase()) ||
                    recipe.history.toLowerCase().includes(searchTerm.toLowerCase())
                );
            }

            // Sort recipes
            const sortBy = document.getElementById('sortSelect').value;
            filteredRecipes.sort((a, b) => {
                switch(sortBy) {
                    case 'date-desc':
                        return new Date(b.dateCreated) - new Date(a.dateCreated);
                    case 'date-asc':
                        return new Date(a.dateCreated) - new Date(b.dateCreated);
                    case 'title-asc':
                        return a.title.localeCompare(b.title);
                    case 'title-desc':
                        return b.title.localeCompare(a.title);
                    case 'rating-desc':
                        return b.rating - a.rating;
                    case 'rating-asc':
                        return a.rating - b.rating;
                    default:
                        return new Date(b.dateCreated) - new Date(a.dateCreated);
                }
            });

            if (filteredRecipes.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <h3>${searchTerm ? 'No recipes found' : 'No recipes yet!'}</h3>
                        <p>${searchTerm ? 'Try adjusting your search terms.' : 'Start by adding your first recipe using the "Add Recipe" tab.'}</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = filteredRecipes.map(recipe => `
                <div class="recipe-card" onclick="viewRecipe(${recipe.id})">
                    <div class="recipe-title">${recipe.title}</div>
                    <div class="recipe-meta">
                        <span>${new Date(recipe.dateCreated).toLocaleDateString()}</span>
                        <div class="rating">
                            ${generateStars(recipe.rating)}
                        </div>
                    </div>
                    <div class="recipe-preview">${recipe.content.substring(0, 150)}...</div>
                </div>
            `).join('');
        }

        function generateStars(rating) {
            let stars = '';
            for (let i = 1; i <= 5; i++) {
                if (i <= rating) {
                    stars += '<span class="star">‚≠ê</span>';
                } else {
                    stars += '<span class="star empty">‚≠ê</span>';
                }
            }
            return stars;
        }

        function viewRecipe(id) {
            const recipe = recipes.find(r => r.id === id);
            if (!recipe) return;

            const modal = document.getElementById('recipeModal');
            const modalContent = document.getElementById('modalContent');

            modalContent.innerHTML = `
                <div class="recipe-title">${recipe.title}</div>
                <div class="recipe-meta">
                    <span>Created: ${new Date(recipe.dateCreated).toLocaleDateString()}</span>
                    <div class="rating">${generateStars(recipe.rating)}</div>
                </div>
                
                <div class="recipe-content">${recipe.content}</div>
                
                ${recipe.history ? `
                    <div class="history-section">
                        <h3>Cooking History & Notes</h3>
                        <div class="recipe-content">${recipe.history}</div>
                    </div>
                ` : ''}
                
                <div style="margin-top: 30px;">
                    <button class="btn" onclick="editRecipe(${recipe.id})">Edit Recipe</button>
                    <button class="btn btn-secondary" onclick="deleteRecipe(${recipe.id})">Delete Recipe</button>
                    <button class="btn btn-secondary" onclick="downloadRecipe(${recipe.id})">Download Markdown</button>
                </div>
            `;

            modal.classList.add('active');
        }

        function closeModal() {
            document.getElementById('recipeModal').classList.remove('active');
        }

        function editRecipe(id) {
            const recipe = recipes.find(r => r.id === id);
            if (!recipe) return;

            // Fill form with existing data
            document.getElementById('recipeTitle').value = recipe.title;
            document.getElementById('recipeRating').value = recipe.rating;
            document.getElementById('recipeContent').value = recipe.content;
            document.getElementById('recipeHistory').value = recipe.history;

            // Remove the recipe from array (will be re-added when saved)
            recipes = recipes.filter(r => r.id !== id);
            localStorage.setItem('recipes', JSON.stringify(recipes));

            // Switch to add tab
            closeModal();
            switchTab('add');
            document.querySelector('[onclick="switchTab(\'add\')"]').click();
        }

        function deleteRecipe(id) {
            if (confirm('Are you sure you want to delete this recipe?')) {
                recipes = recipes.filter(r => r.id !== id);
                localStorage.setItem('recipes', JSON.stringify(recipes));
                closeModal();
                displayRecipes();
            }
        }

        function downloadRecipe(id) {
            const recipe = recipes.find(r => r.id === id);
            if (!recipe) return;

            const markdownContent = generateMarkdownFile(recipe);
            downloadMarkdownFile(recipe.title, markdownContent);
        }

        function clearForm() {
            document.getElementById('recipeForm').reset();
        }

        // Close modal when clicking outside
        document.getElementById('recipeModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });

        // Demo recipes for illustration
        if (recipes.length === 0) {
            recipes = [
                {
                    id: 1,
                    title: "Classic Chocolate Chip Cookies",
                    rating: 5,
                    content: `## Ingredients
- 2¬º cups all-purpose flour
- 1 tsp baking soda
- 1 tsp salt
- 1 cup butter, softened
- ¬æ cup brown sugar
- ¬æ cup white sugar
- 2 large eggs
- 2 tsp vanilla extract
- 2 cups chocolate chips

## Instructions
1. Preheat oven to 375¬∞F (190¬∞C)
2. Mix flour, baking soda, and salt in a bowl
3. Cream butter and sugars until fluffy
4. Beat in eggs and vanilla
5. Gradually mix in flour mixture
6. Stir in chocolate chips
7. Drop rounded tablespoons onto ungreased cookie sheets
8. Bake 9-11 minutes until golden brown
9. Cool on baking sheet for 2 minutes before removing

## Notes
- Makes about 48 cookies
- Store in airtight container for up to 1 week`,
                    history: `## Cooking History

### 2025-08-28
Made these for a family gathering. Everyone raved about them! Used dark chocolate chips instead of regular ones - definitely doing that again.

### 2025-07-15
First time making this recipe. Turned out perfectly! The secret is not overbaking them.

## Future Notes
- Try adding chopped walnuts next time
- Consider using brown butter for deeper flavor`,
                    dateCreated: '2025-07-15T10:30:00Z',
                    dateModified: '2025-08-28T15:45:00Z'
                },
                {
                    id: 2,
                    title: "Homemade Pizza Dough",
                    rating: 4,
                    content: `## Ingredients
- 3 cups bread flour
- 1 tsp salt
- 1 tsp active dry yeast
- 1 cup warm water
- 2 tbsp olive oil
- 1 tsp sugar

## Instructions
1. Dissolve yeast and sugar in warm water, let sit 5 minutes
2. Mix flour and salt in large bowl
3. Add yeast mixture and olive oil
4. Knead for 8-10 minutes until smooth
5. Place in oiled bowl, cover, rise 1 hour
6. Punch down, divide for pizzas
7. Roll out and add toppings

## Notes
- Makes 2 medium pizzas
- Dough can be refrigerated up to 3 days`,
                    history: `## Cooking History

### 2025-08-20
Made pizza night with the family. The dough was perfect! Kids loved making their own pizzas.

## Future Notes
- Try whole wheat flour blend
- Experiment with longer fermentation time`,
                    dateCreated: '2025-08-20T18:20:00Z',
                    dateModified: '2025-08-20T18:20:00Z'
                }
            ];
            localStorage.setItem('recipes', JSON.stringify(recipes));
            displayRecipes();
        }
    </script>
</body>
</html>
